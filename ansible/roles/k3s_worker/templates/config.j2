node-name: {{ k3s_node_name }}
token: {{ k3s_token }}
server: https://{{ k3s_master_domain_name }}:6443

node-external-ip: {{ host_ip_address }}
flannel-iface: "{{ k3s_flannel_iface | default('eth0') }}"

{% if k3s_node_label is defined %}
node-label:
{% for label in k3s_node_label %}
  - "{{ label }}"
{% endfor %}
{% endif %}

kubelet-arg:
  - "image-gc-high-threshold=65"
  - "image-gc-low-threshold=60"
  - "kube-reserved=cpu=100m,memory=100Mi,ephemeral-storage=2Gi"
  - "system-reserved=cpu=100m,memory=100Mi,ephemeral-storage=2Gi"
  - "eviction-hard=imagefs.available<5%,imagefs.inodesFree<3%,memory.available<500Mi,nodefs.available<5%,nodefs.inodesFree<3%,pid.available<5%"
  - "max-pods={{ k3s_max_pods | default(90) }}"

kube-proxy-arg:
  - "metrics-bind-address=0.0.0.0"

prefer-bundled-bin: true